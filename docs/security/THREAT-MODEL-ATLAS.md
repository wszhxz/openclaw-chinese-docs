# OpenClaw 威脅模型 v1.0

## MITRE ATLAS 框架

**版本:** 1.0-draft
**最后更新:** 2026-02-04
**方法论:** MITRE ATLAS + 数据流图
**框架:** [MITRE ATLAS](https://atlas.mitre.org/) (AI系统的對抗性威脅環境)

### 框架归属

该威胁模型基于[MITRE ATLAS](https://atlas.mitre.org/)，这是用于记录对AI/ML系统的对抗性威胁的行业标准框架。ATLAS由[MITRE](https://www.mitre.org/)与AI安全社区合作维护。

**关键ATLAS资源:**

- [ATLAS 技术](https://atlas.mitre.org/techniques/)
- [ATLAS 战术](https://atlas.mitre.org/tactics/)
- [ATLAS 案例研究](https://atlas.mitre.org/studies/)
- [ATLAS GitHub](https://github.com/mitre-atlas/atlas-data)
- [贡献给ATLAS](https://atlas.mitre.org/resources/contribute)

### 贡献给此威胁模型

这是一个由OpenClaw社区维护的活文档。有关贡献指南，请参阅[CONTRIBUTING-THREAT-MODEL.md](./CONTRIBUTING-THREAT-MODEL.md)：

- 报告新威胁
- 更新现有威胁
- 提出攻击链
- 建议缓解措施

---

## 1. 引言

### 1.1 目的

本威胁模型使用专门为AI/ML系统设计的MITRE ATLAS框架，记录对OpenClaw AI代理平台和ClawHub技能市场的对抗性威胁。

### 1.2 范围

| 组件               | 包含   | 备注                                             |
| ------------------ | ------ | ------------------------------------------------ |
| OpenClaw代理运行时 | 是     | 核心代理执行、工具调用、会话                     |
| 网关               | 是     | 认证、路由、通道集成                             |
| 通道集成           | 是     | WhatsApp, Telegram, Discord, Signal, Slack等     |
| ClawHub市场        | 是     | 技能发布、审核、分发                             |
| MCP服务器          | 是     | 外部工具提供商                                   |
| 用户设备           | 部分   | 移动应用、桌面客户端                             |

### 1.3 不在范围之内

本威胁模型没有明确排除任何内容。

---

## 2. 系统架构

### 2.1 信任边界

```
┌─────────────────────────────────────────────────────────────────┐
│                    UNTRUSTED ZONE                                │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │
│  │  WhatsApp   │  │  Telegram   │  │   Discord   │  ...

│
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘              │
│         │                │                │                      │
└─────────┼────────────────┼────────────────┼──────────────────────┘
          │                │                │
          ▼                ▼                ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 1: Channel Access                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      GATEWAY                              │   │
│  │  • Device Pairing (30s grace period)                      │   │
│  │  • AllowFrom / AllowList validation                       │   │
│  │  • Token/Password/Tailscale auth                          │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 2: Session Isolation              │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   AGENT SESSIONS                          │   │
│  │  • Session key = agent:channel:peer                       │   │
│  │  • Tool policies per agent                                │   │
│  │  • Transcript logging                                     │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 3: Tool Execution                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                  EXECUTION SANDBOX                        │   │
│  │  • Docker sandbox OR Host (exec-approvals)                │   │
│  │  • Node remote execution                                  │   │
│  │  • SSRF protection (DNS pinning + IP blocking)            │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 4: External Content               │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │              FETCHED URLs / EMAILS / WEBHOOKS             │   │
│  │  • External content wrapping (XML tags)                   │   │
│  │  • Security notice injection                              │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                 TRUST BOUNDARY 5: Supply Chain                   │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                      CLAWHUB                              │   │
│  │  • Skill publishing (semver, SKILL.md required)           │   │
│  │  • Pattern-based moderation flags                         │   │
│  │  • VirusTotal scanning (coming soon)                      │   │
│  │  • GitHub account age verification                        │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```.

### 2.2 数据流

| 流   | 源      | 目的地    | 数据               | 保护               |
| ---- | ------- | --------- | ------------------ | ------------------ |
| F1   | Channel | Gateway   | 用户消息           | TLS, AllowFrom     |
| F2   | Gateway | Agent     | 路由消息           | 会话隔离           |
| F3   | Agent   | Tools     | 工具调用           | 策略执行           |
| F4   | Agent   | External  | web_fetch 请求     | SSRF 阻止          |
| F5   | ClawHub | Agent     | 技能代码           | 审核, 扫描         |
| F6   | Agent   | Channel   | 响应               | 输出过滤           |

---

## 3. ATLAS 战术威胁分析

### 3.1 侦察 (AML.TA0002)

#### T-RECON-001: 代理端点发现

| 属性                  | 值                                                                 |
| --------------------- | ------------------------------------------------------------------ |
| **ATLAS ID**          | AML.T0006 - 主动扫描                                               |
| **描述**              | 攻击者扫描暴露的 OpenClaw 网关端点                                 |
| **攻击向量**          | 网络扫描, shodan 查询, DNS 枚举                                    |
| **受影响组件**        | 网关, 暴露的 API 端点                                            |
| **当前缓解措施**      | Tailscale 认证选项, 默认绑定到回环接口                               |
| **剩余风险**          | 中等 - 公共网关可被发现                                            |
| **建议**              | 文档安全部署, 在发现端点上添加速率限制                             |

#### T-RECON-002: 通道集成探测

| 属性                  | 值                                                               |
| --------------------- | ---------------------------------------------------------------- |
| **ATLAS ID**          | AML.T0006 - 主动扫描                                             |
| **描述**              | 攻击者探测消息通道以识别由 AI 管理的账户                           |
| **攻击向量**          | 发送测试消息, 观察响应模式                                       |
| **受影响组件**        | 所有通道集成                                                     |
| **当前缓解措施**      | 无特定措施                                                       |
| **剩余风险**          | 低 - 单独发现的价值有限                                          |
| **建议**              | 考虑响应时间随机化                                               |

---

### 3.2 初始访问 (AML.TA0004)

#### T-ACCESS-001: 配对码拦截

| 属性                  | 值                                                         |
| ---------------------- | ---------------------------------------------------------- |
| **ATLAS ID**           | AML.T0040 - AI Model Inference API Access                  |
| **描述**               | 攻击者在30秒宽限期期间拦截配对码                         |
| **攻击向量**           | 肩窥、网络嗅探、社会工程                                   |
| **受影响组件**         | 设备配对系统                                               |
| **当前缓解措施**       | 30秒过期，通过现有通道发送代码                             |
| **剩余风险**           | 中等 - 宽限期可被利用                                      |
| **建议**               | 减少宽限期，添加确认步骤                                   |

#### T-ACCESS-002: AllowFrom 欺骗

| 属性                  | 值                                                                         |
| ---------------------- | -------------------------------------------------------------------------- |
| **ATLAS ID**           | AML.T0040 - AI Model Inference API Access                                  |
| **描述**               | 攻击者在通道中伪造允许的发件人身份                                             |
| **攻击向量**           | 根据通道不同 - 电话号码伪造、用户名冒充                                        |
| **受影响组件**         | 按通道验证AllowFrom                                                      |
| **当前缓解措施**       | 特定通道的身份验证                                                     |
| **剩余风险**           | 中等 - 某些通道容易受到欺骗                                                |
| **建议**               | 文档特定通道的风险，在可能的情况下添加加密验证                                 |

#### T-ACCESS-003: 令牌被盗

| 属性                  | 值                                                      |
| ---------------------- | ------------------------------------------------------- |
| **ATLAS ID**           | AML.T0040 - AI Model Inference API Access               |
| **描述**               | 攻击者从配置文件中窃取认证令牌                          |
| **攻击向量**           | 恶意软件、未经授权的设备访问、配置备份泄露              |
| **受影响组件**         | ~/.openclaw/credentials/, 配置存储                      |
| **当前缓解措施**       | 文件权限                                                |
| **剩余风险**           | 高 - 令牌以明文形式存储                                   |
| **建议**               | 实现静态令牌加密，添加令牌轮换                            |

---

### 3.3 执行 (AML.TA0005)

#### T-EXEC-001: 直接提示注入

| 属性               | 值                                                                                     |
| ------------------- | ----------------------------------------------------------------------------------------- |
| **ATLAS ID**        | AML.T0051.000 - LLM Prompt Injection: Direct                                              |
| **描述**            | 攻击者发送精心构造的提示以操纵代理行为                               |
| **攻击向量**        | 包含对抗性指令的通道消息                                      |
| **受影响组件**      | 代理LLM，所有输入表面                                                             |
| **当前缓解措施**    | 模式检测，外部内容包装                                              |
| **剩余风险**        | 关键 - 仅检测，无阻止；复杂攻击可绕过                      |
| **建议**            | 实施多层防御，输出验证，敏感操作的用户确认 |

#### T-EXEC-002: 间接提示注入

| 属性               | 值                                                       |
| ------------------- | ----------------------------------------------------------- |
| **ATLAS ID**        | AML.T0051.001 - LLM Prompt Injection: Indirect              |
| **描述**            | 攻击者在获取的内容中嵌入恶意指令   |
| **攻击向量**        | 恶意URL，中毒电子邮件，被攻陷的Webhook       |
| **受影响组件**      | web_fetch, email ingestion, 外部数据源           |
| **当前缓解措施**    | 使用XML标签包装内容和安全通知          |
| **剩余风险**        | 高 - LLM可能忽略包装指令                  |
| **建议**            | 实施内容清理，分离执行上下文 |

#### T-EXEC-003: 工具参数注入

| 属性               | 值                                                        |
| ------------------- | ------------------------------------------------------------ |
| **ATLAS ID**        | AML.T0051.000 - LLM Prompt Injection: Direct                 |
| **描述**            | 攻击者通过提示注入操纵工具参数 |
| **攻击向量**        | 影响工具参数值的精心构造的提示         |
| **受影响组件**      | 所有工具调用                                         |
| **当前缓解措施**    | 危险命令的执行审批                        |
| **剩余风险**        | 高 - 依赖用户判断                               |
| **建议**            | 实施参数验证，参数化工具调用      |

#### T-EXEC-004: 执行审批绕过

| 属性                  | 值                                                         |
| --------------------- | ------------------------------------------------------------ |
| **ATLAS ID**          | AML.T0043 - Craft Adversarial Data                           |
| **描述**              | 攻击者编制绕过审批白名单的命令                               |
| **攻击向量**          | 命令混淆、别名利用、路径操作                                 |
| **受影响组件**        | exec-approvals.ts, 命令白名单                                |
| **当前缓解措施**      | 白名单 + 请求模式                                            |
| **剩余风险**          | 高 - 无命令清理                                              |
| **建议**              | 实现命令规范化，扩展黑名单                                   |

---

### 3.4 持久化 (AML.TA0006)

#### T-PERSIST-001: 恶意技能安装

| 属性                  | 值                                                                       |
| --------------------- | ------------------------------------------------------------------------ |
| **ATLAS ID**          | AML.T0010.001 - 供应链妥协：AI软件                                   |
| **描述**              | 攻击者在ClawHub发布恶意技能                                        |
| **攻击向量**          | 创建账户，发布带有隐藏恶意代码的技能                                 |
| **受影响组件**        | ClawHub, 技能加载, 代理执行                                          |
| **当前缓解措施**      | GitHub账户年龄验证，基于模式的审核标志                               |
| **剩余风险**          | 严重 - 无沙箱，有限审查                                          |
| **建议**              | VirusTotal集成（进行中），技能沙箱，社区审查                         |

#### T-PERSIST-002: 技能更新中毒

| 属性                  | 值                                                             |
| --------------------- | -------------------------------------------------------------- |
| **ATLAS ID**          | AML.T0010.001 - 供应链妥协：AI软件                             |
| **描述**              | 攻击者攻陷流行技能并推送恶意更新                                 |
| **攻击向量**          | 账户攻陷，对技能所有者的社会工程                                 |
| **受影响组件**        | ClawHub版本控制，自动更新流程                                    |
| **当前缓解措施**      | 版本指纹识别                                                   |
| **剩余风险**          | 高 - 自动更新可能拉取恶意版本                                    |
| **建议**              | 实现更新签名，回滚功能，版本固定                                 |

#### T-PERSIST-003: 代理配置篡改

| 属性                  | 值                                                            |
| --------------------- | ------------------------------------------------------------- |
| **ATLAS ID**          | AML.T0010.002 - Supply Chain Compromise: Data                 |
| **描述**              | 攻击者修改代理配置以持久化访问                                |
| **攻击向量**          | 配置文件修改，设置注入                                        |
| **受影响组件**        | 代理配置，工具策略                                            |
| **当前缓解措施**      | 文件权限                                                      |
| **剩余风险**          | 中等 - 需要本地访问                                           |
| **建议**              | 配置完整性验证，配置更改的审计日志                            |

---

### 3.5 防御规避 (AML.TA0007)

#### T-EVADE-001: 调制模式绕过

| 属性                  | 值                                                                   |
| --------------------- | -------------------------------------------------------------------- |
| **ATLAS ID**          | AML.T0043 - Craft Adversarial Data                                   |
| **描述**              | 攻击者制作技能内容以规避调制模式                                 |
| **攻击向量**          | Unicode 同形字，编码技巧，动态加载                               |
| **受影响组件**        | ClawHub moderation.ts                                              |
| **当前缓解措施**      | 基于模式的 FLAG_RULES                                            |
| **剩余风险**          | 高 - 简单正则表达式容易被绕过                                    |
| **建议**              | 添加行为分析（VirusTotal Code Insight），基于AST的检测           |

#### T-EVADE-002: 内容包装器逃逸

| 属性                  | 值                                                    |
| --------------------- | ----------------------------------------------------- |
| **ATLAS ID**          | AML.T0043 - Craft Adversarial Data                    |
| **描述**              | 攻击者制作能够逃离XML包装器上下文的内容                |
| **攻击向量**          | 标签操作，上下文混淆，指令覆盖                            |
| **受影响组件**        | 外部内容包装                                            |
| **当前缓解措施**      | XML标签 + 安全通知                                      |
| **剩余风险**          | 中等 - 新的逃逸方法定期被发现                             |
| **建议**              | 多层包装器，输出端验证                                    |

---

### 3.6 发现 (AML.TA0008)

#### T-DISC-001: 工具枚举

| 属性                  | 值                                                    |
| ------------------- | ----------------------------------------------------- |
| **ATLAS ID**        | AML.T0040 - AI Model Inference API Access             |
| **描述**            | 攻击者通过提示枚举可用工具                              |
| **攻击向量**        | "你有哪些工具？" 样式的查询                             |
| **受影响组件**      | 代理工具注册表                                        |
| **当前缓解措施**    | 无特定措施                                            |
| **剩余风险**        | 低 - 工具通常已记录                                   |
| **建议**            | 考虑工具可见性控制                                    |

#### T-DISC-002: 会话数据提取

| 属性                  | 值                                                    |
| ------------------- | ----------------------------------------------------- |
| **ATLAS ID**        | AML.T0040 - AI Model Inference API Access             |
| **描述**            | 攻击者从会话上下文中提取敏感数据                        |
| **攻击向量**        | "我们讨论了什么？" 查询，上下文探测                     |
| **受影响组件**      | 会话记录，上下文窗口                                  |
| **当前缓解措施**    | 按发送者隔离会话                                      |
| **剩余风险**        | 中等 - 会话内数据可访问                               |
| **建议**            | 在上下文中实现敏感数据擦除                            |

---

### 3.7 数据收集与泄露 (AML.TA0009, AML.TA0010)

#### T-EXFIL-001: 通过 web_fetch 进行数据窃取

| 属性                  | 值                                                                      |
| ------------------- | ----------------------------------------------------------------------- |
| **ATLAS ID**        | AML.T0009 - Collection                                                  |
| **描述**            | 攻击者通过指示代理将数据发送到外部URL来泄露数据                              |
| **攻击向量**        | 提示注入导致代理将数据POST到攻击者服务器                                     |
| **受影响组件**      | web_fetch 工具                                                              |
| **当前缓解措施**    | 对内部网络进行SSRF阻止                                                      |
| **剩余风险**        | 高 - 允许外部URL                                                            |
| **建议**            | 实现URL白名单，数据分类意识                                                   |

#### T-EXFIL-002: 未经授权的消息发送

| 属性               | 值                                                            |
| ----------------------- | ---------------------------------------------------------------- |
| **ATLAS ID**            | AML.T0009 - Collection                                           |
| **描述**         | 攻击者使代理发送包含敏感数据的消息 |
| **攻击向量**       | 提示注入导致代理向攻击者发送消息               |
| **受影响组件** | 消息工具, 频道集成                               |
| **当前缓解措施** | 出站消息网关                                        |
| **剩余风险**       | 中等 - 网关可能被绕过                                  |
| **建议**     | 要求新收件人显式确认                 |

#### T-EXFIL-003: 凭证收集

| 属性               | 值                                                   |
| ----------------------- | ------------------------------------------------------- |
| **ATLAS ID**            | AML.T0009 - Collection                                  |
| **描述**         | 恶意技能从代理上下文中收集凭证 |
| **攻击向量**       | 技能代码读取环境变量, 配置文件    |
| **受影响组件** | 技能执行环境                             |
| **当前缓解措施** | 无特定于技能的措施                                 |
| **剩余风险**       | 严重 - 技能以代理权限运行             |
| **建议**     | 技能沙箱化, 凭证隔离                  |

---

### 3.8 影响 (AML.TA0011)

#### T-IMPACT-001: 未经授权的命令执行

| 属性               | 值                                               |
| ----------------------- | --------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - 损坏AI模型完整性                |
| **描述**         | 攻击者在用户系统上执行任意命令 |
| **攻击向量**       | 提示注入结合exec审批绕过 |
| **受影响组件** | Bash工具, 命令执行                        |
| **当前缓解措施** | exec审批, Docker沙箱选项               |
| **剩余风险**       | 严重 - 主机执行无沙箱           |
| **建议**     | 默认使用沙箱, 改进审批UX             |

#### T-IMPACT-002: 资源耗尽 (DoS)

| 属性               | 值                                              |
| ----------------------- | -------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - Erode AI Model Integrity               |
| **描述**         | 攻击者耗尽API信用额度或计算资源 |
| **攻击向量**       | 自动化消息泛滥，昂贵的工具调用   |
| **受影响组件** | 网关，代理会话，API提供商              |
| **当前缓解措施** | 无                                               |
| **剩余风险**       | 高 - 无速率限制                            |
| **建议**     | 实施每发送者速率限制，成本预算     |

#### T-IMPACT-003: 声誉损害

| 属性               | 值                                                   |
| ----------------------- | ------------------------------------------------------- |
| **ATLAS ID**            | AML.T0031 - Erode AI Model Integrity                    |
| **描述**         | 攻击者使代理发送有害/冒犯性内容 |
| **攻击向量**       | 提示注入导致不适当的响应        |
| **受影响组件** | 输出生成，频道消息                    |
| **当前缓解措施** | LLM提供商内容策略                           |
| **剩余风险**       | 中等 - 提供商过滤不完善                     |
| **建议**     | 输出过滤层，用户控制                   |

---

## 4. ClawHub 供应链分析

### 4.1 当前安全控制

| 控制              | 实现              | 有效性                                        |
| -------------------- | --------------------------- | ---------------------------------------------------- |
| GitHub账户年龄   | `requireGitHubAccountAge()` | 中等 - 提高新攻击者的门槛                |
| 路径清理    | `sanitizePath()`            | 高 - 防止路径遍历                       |
| 文件类型验证 | `isTextFile()`              | 中等 - 仅文本文件，但仍可能恶意 |
| 大小限制          | 总共50MB捆绑           | 高 - 防止资源耗尽                  |
| 必需的SKILL.md    | 强制性自述            | 低安全价值 - 仅信息性              |
| 模式审核   | `moderationStatus` 字段    | 中等 - 可能进行人工审查                      |

### 4.2 审核标志模式

当前模式在 `moderation.ts`:

```javascript
// 已知不良标识符
/(keepcold131\/ClawdAuthenticatorTool|ClawdAuthenticatorTool)/i`

// 可疑关键词
/(malware|stealer|phish|phishing|keylogger)/i
/(api[-_ ]?key|token|password|private key|secret)/i
/(wallet|seed phrase|mnemonic|crypto)/i
/(discord\.gg|webhook|hooks\.slack)/i
/(curl[^\n]+\|\s*(sh|bash))/i
/(bit\.ly|tinyurl\.com|t\.co|goo\.gl|is\.gd)/i
```

**Limitations:**

- Only checks slug, displayName, summary, frontmatter, metadata, file paths
- Does not analyze actual skill code content
- Simple regex easily bypassed with obfuscation
- No behavioral analysis

### 4.3 Planned Improvements

| Improvement            | Status                                | Impact                                                                |
| ---------------------- | ------------------------------------- | --------------------------------------------------------------------- |
| VirusTotal Integration | In Progress                           | High - Code Insight behavioral analysis                               |
| Community Reporting    | Partial (`skillReports` table exists) | Medium                                                                |
| Audit Logging          | Partial (`auditLogs` table exists)    | Medium                                                                |
| Badge System           | Implemented                           | Medium - `highlighted`, `official`, `deprecated`, `redactionApproved` |

---

## 5. Risk Matrix

### 5.1 Likelihood vs Impact

| Threat ID     | Likelihood | Impact   | Risk Level   | Priority |
| ------------- | ---------- | -------- | ------------ | -------- |
| T-EXEC-001    | High       | Critical | **Critical** | P0       |
| T-PERSIST-001 | High       | Critical | **Critical** | P0       |
| T-EXFIL-003   | Medium     | Critical | **Critical** | P0       |
| T-IMPACT-001  | Medium     | Critical | **High**     | P1       |
| T-EXEC-002    | High       | High     | **High**     | P1       |
| T-EXEC-004    | Medium     | High     | **High**     | P1       |
| T-ACCESS-003  | Medium     | High     | **High**     | P1       |
| T-EXFIL-001   | Medium     | High     | **High**     | P1       |
| T-IMPACT-002  | High       | Medium   | **High**     | P1       |
| T-EVADE-001   | High       | Medium   | **Medium**   | P2       |
| T-ACCESS-001  | Low        | High     | **Medium**   | P2       |
| T-ACCESS-002  | Low        | High     | **Medium**   | P2       |
| T-PERSIST-002 | Low        | High     | **Medium**   | P2       |

### 5.2 Critical Path Attack Chains

**Attack Chain 1: Skill-Based Data Theft**

```
T-PERSIST-001 → T-EVADE-001 → T-EXFIL-003
(Publish malicious skill) → (Evade moderation) → (Harvest credentials)
```

**Attack Chain 2: Prompt Injection to RCE**

```
T-EXEC-001 → T-EXEC-004 → T-IMPACT-001
(Inject prompt) → (Bypass exec approval) → (Execute commands)
```

**Attack Chain 3: Indirect Injection via Fetched Content**

```
T-EXEC-002 → T-EXFIL-001 → External exfiltration
(Poison URL content) → (Agent fetches & follows instructions) → (Data sent to attacker)
``

## 6. 推荐总结

### 6.1 立即执行 (P0)

| ID    | 推荐                              | 解决问题                  |
| ----- | ------------------------------------------- | -------------------------- |
| R-001 | 完成 VirusTotal 集成             | T-PERSIST-001, T-EVADE-001 |
| R-002 | 实现技能沙箱                  | T-PERSIST-001, T-EXFIL-003 |
| R-003 | 为敏感操作添加输出验证 | T-EXEC-001, T-EXEC-002     |

### 6.2 短期 (P1)

| ID    | 推荐                           | 解决问题    |
| ----- | ---------------------------------------- | ------------ |
| R-004 | 实现速率限制                  | T-IMPACT-002 |
| R-005 | 添加静态令牌加密             | T-ACCESS-003 |
| R-006 | 改进 exec 批准用户体验和验证  | T-EXEC-004   |
| R-007 | 为 web_fetch 实现 URL 白名单 | T-EXFIL-001  |

### 6.3 中期 (P2)

| ID    | 推荐                                        | 解决问题     |
| ----- | ----------------------------------------------------- | ------------- |
| R-008 | 在可能的情况下添加加密通道验证 | T-ACCESS-002  |
| R-009 | 实现配置完整性验证               | T-PERSIST-003 |
| R-010 | 添加更新签名和版本固定                | T-PERSIST-002 |

---

## 7. 附录

### 7.1 ATLAS 技术映射

| ATLAS ID      | 技术名称                 | OpenClaw 威脅                                                 |
| ------------- | ------------------------------ | ---------------------------------------------------------------- |
| AML.T0006     | 主动扫描                | T-RECON-001, T-RECON-002                                         |
| AML.T0009     | 收集                     | T-EXFIL-001, T-EXFIL-002, T-EXFIL-003                            |
| AML.T0010.001 | 供应链：AI 软件      | T-PERSIST-001, T-PERSIST-002                                     |
| AML.T0010.002 | 供应链：数据             | T-PERSIST-003                                                    |
| AML.T0031     | 损坏 AI 模型完整性       | T-IMPACT-001, T-IMPACT-002, T-IMPACT-003                         |
| AML.T0040     | AI 模型推理 API 访问  | T-ACCESS-001, T-ACCESS-002, T-ACCESS-003, T-DISC-001, T-DISC-002 |
| AML.T0043     | 构造对抗性数据         | T-EXEC-004, T-EVADE-001, T-EVADE-002                             |
| AML.T0051.000 | LLM 提示注入：直接   | T-EXEC-001, T-EXEC-003                                           |
| AML.T0051.001 | LLM 提示注入：间接 | T-EXEC-002                                                       |

### 7.2 关键安全文件

| 路径                                | 目的                     | 风险级别   |
| ----------------------------------- | --------------------------- | ------------ |
| `src/infra/exec-approvals.ts`       | 命令审批逻辑      | **Critical** |
| `src/gateway/auth.ts`               | 网关认证      | **Critical** |
| `src/web/inbound/access-control.ts` | 通道访问控制      | **Critical** |
| `src/infra/net/ssrf.ts`             | SSRF保护             | **Critical** |
| `src/security/external-content.ts`  | 提示注入缓解 | **Critical** |
| `src/agents/sandbox/tool-policy.ts` | 工具策略执行     | **Critical** |
| `convex/lib/moderation.ts`          | ClawHub审核          | **High**     |
| `convex/lib/skillPublish.ts`        | 技能发布流程       | **High**     |
| `src/routing/resolve-route.ts`      | 会话隔离           | **Medium**   |

### 7.3 术语表

| 术语                 | 定义                                                |
| -------------------- | --------------------------------------------------------- |
| **ATLAS**            | MITRE的人工智能系统的对抗性威胁态势       |
| **ClawHub**          | OpenClaw的技能市场                              |
| **Gateway**          | OpenClaw的消息路由和认证层       |
| **MCP**              | 模型上下文协议 - 工具提供商接口          |
| **Prompt Injection** | 攻击者在输入中嵌入恶意指令的攻击 |
| **Skill**            | OpenClaw代理人的可下载扩展                |
| **SSRF**             | 服务器端请求伪造                               |

---

_此威胁模型是一个活文档。请将安全问题报告至security@openclaw.ai_