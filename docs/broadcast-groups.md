---
summary: "Broadcast a WhatsApp message to multiple agents"
read_when:
  - Configuring broadcast groups
  - Debugging multi-agent replies in WhatsApp
status: experimental
title: "Broadcast Groups"
---
# 广播组

**状态：** 实验性  
**版本：** 2026.1.9 引入

## 概述

广播组允许多个代理同时处理和响应同一消息。这使您可以创建专门化的代理团队，在一个 WhatsApp 群组或私聊中协作工作——全部使用一个电话号码。

当前范围：**仅限 WhatsApp**（网页通道）。

广播组在通道白名单和群组激活规则之后进行评估。在 WhatsApp 群组中，这意味着广播会在 OpenClaw 通常回复时发生（例如：在提及时，取决于您的群组设置）。

## 使用场景

### 1. 专门化的代理团队

部署具有原子化、专注职责的多个代理：

```
组: "开发团队"
代理:
  - 代码审查员（审查代码片段）
  - 文档生成器（生成文档）
  - 安全审计员（检查漏洞）
  - 测试生成器（建议测试用例）
```

每个代理处理相同的消息并提供其专门化的视角。

### 2. 多语言支持

```
组: "国际支持"
代理:
  - 英语代理（用英语回复）
  - 德语代理（用德语回复）
  - 西班牙语代理（用西班牙语回复）
```

### 3. 质量保证工作流

```
组: "客户支持"
代理:
  - 支持代理（提供答案）
  - QA 代理（审查质量，仅在发现问题时回复）
```

### 4. 任务自动化

```
组: "项目管理"
代理:
  - 任务跟踪器（更新任务数据库）
  - 时间记录器（记录花费时间）
  - 报告生成器（创建摘要）
```

## 配置

### 基本设置

添加一个顶级 `broadcast` 部分（与 `bindings` 平级）。键是 WhatsApp 对等 ID：

- 群聊：群 JID（例如 `120363403215116621@g.us`）
- 私聊：E.164 电话号码（例如 `+15551234567`）

```json
{
  "broadcast": {
    "120363403215116621@g.us": ["alfred", "baerbel", "assistant3"]
  }
}
```

**结果：** 当 OpenClaw 在此聊天中回复时，它将运行所有三个代理。

### 处理策略

控制代理如何处理消息：

#### 并行（默认）

所有代理同时处理：

```json
{
  "broadcast": {
    "strategy": "parallel",
    "120363403215116621@g.us": ["alfred", "baerbel"]
  }
}
```

#### 串行

代理按数组顺序处理：

```json
{
  "broadcast": {
    "strategy": "sequential",
    "120363403215116621@g.us": ["alfred", "baerbel"]
  }
}
```

### 消息流程

消息从发送者到接收者，经过以下步骤：

1. 用户发送消息
2. 消息到达广播组
3. 广播组将消息分发给所有代理
4. 代理处理消息并生成响应
5. 响应返回给用户

### 会话隔离

每个代理在处理消息时，会使用独立的会话环境，确保代理之间不会互相干扰。

## 最佳实践

### 1. 保持代理数量合理

虽然没有硬性限制，但建议每个广播组保持在 10 个代理以内，以避免性能问题。

### 2. 使用轻量级模型

如果代理数量较多，建议使用轻量级模型（如 sonnet 而不是 opus）以提高性能。

### 3. 避免代理间依赖

确保代理之间不依赖彼此的响应，以避免潜在的错误和性能问题。

### 4. 定期清理会话

定期清理不再需要的会话，以释放资源并提高系统性能。

## 兼容性

### 支持的平台

- **WhatsApp**：支持群聊和私聊
- **其他平台**：支持其他对等 ID 类型

## 故障排除

### 问题：仅有一个代理回复

**原因：** 对等 ID 可能在 `bindings` 中但不在 `broadcast` 中。

**解决方法：** 将其添加到广播配置或从 `bindings` 中移除。

### 问题：性能问题

**如果代理数量多时较慢：**

- 减少每个群组的代理数量
- 使用轻量级模型（sonnet 而不是 opus）
- 检查沙箱启动时间

## 示例

### 示例 1：代码审查团队

```json
{
  "broadcast": {
    "strategy": "parallel",
    "120363403215116621@g.us": [
      "代码格式化器",
      "安全扫描器",
      "测试覆盖率",
      "文档检查器"
    ]
  },
  "agents": {
    "list": [
      {
        "id": "代码格式化器",
        "workspace": "~/agents/formatter",
        "tools": { "allow": ["read", "write"] }
      },
      {
        "id": "安全扫描器",
        "workspace": "~/agents/security",
        "tools": { "allow": ["read", "exec"] }
      },
      {
        "id": "测试覆盖率",
        "workspace": "~/agents/testing",
        "tools": { "allow": ["read", "exec"] }
      },
      { "id": "文档检查器", "workspace": "~/agents/docs", "tools": { "allow": ["read"] } }
    ]
  }
}
```

**用户发送：** 代码片段  
**响应：**

- 代码格式化器： "已修复缩进并添加类型提示"
- 安全扫描器： "⚠️ 第 12 行存在 SQL 注入漏洞"
- 测试覆盖率： "覆盖率是 45%，缺少错误情况的测试"
- 文档检查器： "函数 `process_data` 缺少文档字符串"

### 示例 2：多语言支持

```json
{
  "broadcast": {
    "strategy": "sequential",
    "+15555550123": ["语言检测器", "英语翻译器", "德语翻译器"]
  },
  "agents": {
    "list": [
      { "id": "